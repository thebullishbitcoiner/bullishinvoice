import{_ as p}from"./vendor-B0ga06J7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=n(t);fetch(t.href,o)}})();function h(r){return r.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function f(r="INV"){const e=Date.now().toString().slice(-6),n=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`${r}-${e}-${n}`}function E(){return{invoiceDate:new Date().toISOString().split("T")[0]}}function c(r,e="success"){const n=document.createElement("div");n.className=`notification notification-${e}`,n.textContent=r,Object.assign(n.style,{position:"fixed",top:"20px",right:"20px",padding:"15px 20px",borderRadius:"8px",color:"white",fontWeight:"bold",zIndex:"1000",transform:"translateX(100%)",transition:"transform 0.3s ease",maxWidth:"300px",wordWrap:"break-word"});const i={success:"#ff9900",error:"#ff9900",warning:"#ff9900"};n.style.backgroundColor=i[e]||i.success,document.body.appendChild(n),setTimeout(()=>{n.style.transform="translateX(0)"},100),setTimeout(()=>{n.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild(n)},300)},3e3)}function b(r,e){let n;return function(...t){const o=()=>{clearTimeout(n),r(...t)};clearTimeout(n),n=setTimeout(o,e)}}function y(r){const e=document.createElement("div");return e.textContent=r,e.innerHTML}const v={FORM_DATA:"bullish_invoice_form_data",TEMPLATES:"bullish_invoice_templates",SETTINGS:"bullish_invoice_settings"};function T(r){try{localStorage.setItem(v.FORM_DATA,JSON.stringify(r))}catch(e){console.error("Error saving form data:",e)}}function N(){try{const r=localStorage.getItem(v.FORM_DATA);return r?JSON.parse(r):null}catch(r){return console.error("Error loading form data:",r),null}}function q(r,e){try{const n=I();n[r]={...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},localStorage.setItem(v.TEMPLATES,JSON.stringify(n))}catch(n){console.error("Error saving template:",n)}}function I(){try{const r=localStorage.getItem(v.TEMPLATES);return r?JSON.parse(r):{}}catch(r){return console.error("Error loading templates:",r),{}}}function C(r){try{return I()[r]||null}catch(e){return console.error("Error loading template:",e),null}}function _(){try{const r=I();return Object.keys(r)}catch(r){return console.error("Error getting template names:",r),[]}}function $(){try{const r=localStorage.getItem(v.SETTINGS);return r?JSON.parse(r):w()}catch(r){return console.error("Error loading settings:",r),w()}}function w(){return{autoSave:!0,autoSaveInterval:5e3,defaultInvoicePrefix:"INV",defaultCurrency:"sats",theme:"dark"}}class L{constructor(){this.isProcessing=!1,this.currentInvoice=null,this.paymentCheckInterval=null,this.qrElement=null}async createInvoice(){try{const{LightningAddress:e}=await p(async()=>{const{LightningAddress:t}=await import("./index.modern-GuuHck_z.js");return{LightningAddress:t}},[]),n=new e("bullish@blitz-wallet.com");await n.fetch();const i=await n.requestInvoice({satoshi:20});return console.log("Invoice created:",{paymentRequest:i.paymentRequest,paymentHash:i.paymentHash,satoshi:i.satoshi}),i}catch(e){throw console.error("Error creating invoice:",e),new Error("Failed to create Lightning invoice")}}createModalOverlay(){const e=document.createElement("div");return e.id="payment-overlay",e.style.cssText=`
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9998;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: Arial, sans-serif;
        `,e.innerHTML=`
            <div style="text-align: center; padding: 20px; background: rgba(0, 0, 0, 0.9); border-radius: 12px; max-width: 500px;">
                <div style="font-size: 32px; margin-bottom: 15px;">âš¡</div>
                <div style="font-size: 20px; margin-bottom: 10px; font-weight: bold;">Lightning Payment</div>
                <div style="font-size: 16px; margin-bottom: 20px; opacity: 0.8;">Scan QR code to pay 21 sats</div>
                <div id="qr-container" style="display: flex; justify-content: center; margin-bottom: 20px;"></div>
                <div style="font-size: 14px; opacity: 0.7;">Payment will be verified automatically</div>
                <button id="close-payment-modal" style="
                    margin-top: 15px;
                    padding: 8px 16px;
                    background: #ff9900;
                    color: #000;
                    border: none;
                    border-radius: 6px;
                    cursor: pointer;
                    font-weight: bold;
                ">Close</button>
            </div>
        `,document.body.appendChild(e),e.querySelector("#close-payment-modal").addEventListener("click",()=>{this.cancelPayment()}),e}removeModalOverlay(){const e=document.getElementById("payment-overlay");e&&e.remove()}async displayInvoice(e,n){try{const i=document.querySelector("#qr-container");if(!i)throw new Error("QR container not found");const t=document.createElement("bitcoin-qr");t.setAttribute("width","400"),t.setAttribute("height","400"),t.setAttribute("lightning",e.paymentRequest),t.setAttribute("is-polling","true"),t.setAttribute("poll-interval","3000"),t.setAttribute("type","svg"),t.setAttribute("corners-square-color","#ff9900"),t.setAttribute("corners-dot-color","#ff9900"),t.setAttribute("corners-square-type","square"),t.setAttribute("dots-type","square"),t.setAttribute("dots-color","#ff9900"),t.setAttribute("debug","true"),t.callback=async()=>{await this.checkPaymentStatus(e,n)},i.appendChild(t),this.qrElement=t,console.log("QR code displayed for invoice:",e.paymentRequest)}catch(i){throw console.error("Error displaying invoice with bitcoin-qr:",i),new Error("Failed to display invoice")}}async checkPaymentStatus(e,n){try{await e.verifyPayment()&&e.preimage&&(console.log("Payment verified successfully!"),console.log(`Preimage: ${e.preimage}`),this.qrElement&&this.qrElement.setAttribute("is-polling","false"),n(!0))}catch(i){console.error("Error checking payment status:",i)}}cancelPayment(){this.qrElement&&this.qrElement.setAttribute("is-polling","false"),this.paymentCheckInterval&&(clearInterval(this.paymentCheckInterval),this.paymentCheckInterval=null),this.isProcessing=!1,this.currentInvoice=null,this.removeModalOverlay(),c("Payment cancelled.","info")}async handleExportPayment(e,n){if(this.isProcessing){c("Payment already in progress. Please wait.","warning");return}this.isProcessing=!0,this.createModalOverlay();try{c("Creating Lightning invoice...","info");const i=await this.createInvoice();this.currentInvoice=i,console.log("Created invoice:",{paymentRequest:i.paymentRequest,paymentHash:i.paymentHash,satoshi:i.satoshi}),c("Invoice created! Please scan QR code to pay.","success"),await this.displayInvoice(i,async t=>{var o;if(t){c("Payment received! Processing export...","success"),console.log("Payment verified successfully!");const a=(o=this.currentInvoice)==null?void 0:o.preimage;a&&console.log(`Preimage: ${a}`),setTimeout(async()=>{try{await e(...n),c("Export completed successfully!","success")}catch(d){console.error("Error during export:",d),c("Error during export. Please try again.","error")}},3e3)}else c("Payment cancelled.","info");this.isProcessing=!1,this.currentInvoice=null,this.removeModalOverlay()})}catch(i){console.error("Error in payment flow:",i),c("Error processing payment. Please try again.","error"),this.isProcessing=!1,this.currentInvoice=null,this.removeModalOverlay()}}}const B=new L;async function F(r,e){await B.handleExportPayment(k,[r,e])}async function k(r,e){try{const n=(await p(async()=>{const{default:o}=await import("./vendor-B0ga06J7.js").then(a=>a.h);return{default:o}},[])).default,i=await n(r,{backgroundColor:"#ffffff",scale:2,useCORS:!0,allowTaint:!1,logging:!1,scrollX:0,scrollY:0}),t=document.createElement("a");t.download=`${e}.png`,t.href=i.toDataURL("image/png"),document.body.appendChild(t),t.click(),document.body.removeChild(t),c("Image exported successfully!","success")}catch(n){console.error("Error exporting image:",n),c("Error exporting image. Please try again.","error")}}async function R(r,e){await B.handleExportPayment(M,[r,e])}async function M(r,e){try{const n=(await p(async()=>{const{default:u}=await import("./vendor-B0ga06J7.js").then(g=>g.h);return{default:u}},[])).default,{jsPDF:i}=await p(async()=>{const{jsPDF:u}=await import("./vendor-B0ga06J7.js").then(g=>g.j);return{jsPDF:u}},[]),t=await n(r,{backgroundColor:"#ffffff",scale:2,useCORS:!0,allowTaint:!1,logging:!1,scrollX:0,scrollY:0}),o=new i("p","mm","a4"),a=t.toDataURL("image/png"),d=210,l=295,s=d,m=t.height*s/t.width;if(m<=l){const u=(l-m)/2;o.addImage(a,"PNG",0,u,s,m)}else{let u=m,g=0;for(o.addImage(a,"PNG",0,g,s,m),u-=l;u>=0;)g=u-m,o.addPage(),o.addImage(a,"PNG",0,g,s,m),u-=l}o.save(`${e}.pdf`),c("PDF exported successfully!","success")}catch(n){console.error("Error exporting PDF:",n),c("Error exporting PDF. Please try again.","error")}}class O{constructor(){this.settings=$(),this.autoSaveTimer=null,this.lightningPayment=new L,this.currentLightningInvoice="",this.init(),this.loadVersion()}init(){this.setupEventListeners(),this.setupLineItemEventListeners(),this.loadSavedData(),this.setupAutoSave(),this.updatePreview(),this.setupTemplateControls()}setupEventListeners(){document.querySelectorAll("input, textarea").forEach(s=>{s.addEventListener("input",()=>{this.updatePreview(),this.saveFormData()})});const n=document.getElementById("lightningAddress");n&&n.addEventListener("input",b(async s=>{await this.validateLightningAddress(s.target)},500));const i=document.getElementById("generateQRBtn");i&&i.addEventListener("click",async()=>{await this.generateInvoiceFromAddress()});const t=document.getElementById("exportPdfBtn"),o=document.getElementById("exportImageBtn");t&&t.addEventListener("click",()=>{const s=document.getElementById("invoicePreview");s&&R(s,"invoice")}),o&&o.addEventListener("click",()=>{const s=document.getElementById("invoicePreview");s&&F(s,"invoice")}),this.updateQRCodeSize(),window.addEventListener("resize",()=>this.updateQRCodeSize());const a=document.getElementById("lightningAddress");a&&a.addEventListener("blur",async s=>{await this.validateLightningAddress(s.target)});const d=document.getElementById("generateInvoiceNumberBtn");d&&d.addEventListener("click",()=>{this.generateNewInvoiceNumber()});const l=document.getElementById("clearFormBtn");l&&l.addEventListener("click",()=>{this.clearForm()})}getFormData(){var i,t,o,a,d,l;const e=this.getLineItems(),n=e.reduce((s,m)=>s+m.quantity*m.rate,0);return{invoiceNumber:((i=document.getElementById("invoiceNumber"))==null?void 0:i.value)||"INV-001",invoiceDate:((t=document.getElementById("invoiceDate"))==null?void 0:t.value)||"",fromName:((o=document.getElementById("fromName"))==null?void 0:o.value)||"",toName:((a=document.getElementById("toName"))==null?void 0:a.value)||"",lineItems:e,lightningAddress:((d=document.getElementById("lightningAddress"))==null?void 0:d.value)||"",lightningInvoice:this.currentLightningInvoice||"",notes:((l=document.getElementById("notes"))==null?void 0:l.value)||"",total:n}}getLineItems(){const e=[];return document.querySelectorAll(".line-item").forEach(i=>{var l,s,m;const t=i.getAttribute("data-item-id"),o=((l=document.getElementById(`description-${t}`))==null?void 0:l.value)||"",a=parseInt((s=document.getElementById(`quantity-${t}`))==null?void 0:s.value)||1,d=parseInt((m=document.getElementById(`rate-${t}`))==null?void 0:m.value)||0;o.trim()&&e.push({id:t,description:o,quantity:a,rate:d,amount:a*d})}),e}setFormData(e){e.invoiceNumber&&(document.getElementById("invoiceNumber").value=e.invoiceNumber),e.invoiceDate&&(document.getElementById("invoiceDate").value=e.invoiceDate),e.fromName&&(document.getElementById("fromName").value=e.fromName),e.toName&&(document.getElementById("toName").value=e.toName),e.lightningAddress&&(document.getElementById("lightningAddress").value=e.lightningAddress),e.lightningInvoice&&(this.currentLightningInvoice=e.lightningInvoice),e.notes&&(document.getElementById("notes").value=e.notes),e.lineItems&&Array.isArray(e.lineItems)&&this.setLineItems(e.lineItems)}setLineItems(e){const i=document.getElementById("lineItemsContainer").querySelectorAll(".line-item");i.length>0&&(document.getElementById("description-1").value="",document.getElementById("quantity-1").value="1",document.getElementById("rate-1").value="");for(let t=1;t<i.length;t++)i[t].remove();e.forEach((t,o)=>{o===0?(document.getElementById("description-1").value=t.description,document.getElementById("quantity-1").value=t.quantity,document.getElementById("rate-1").value=t.rate):this.addLineItem(t.description,t.quantity,t.rate)}),this.updatePreview()}updatePreview(){const e=this.getFormData(),n=e.total;document.getElementById("previewInvoiceNumber")&&(document.getElementById("previewInvoiceNumber").textContent=e.invoiceNumber),document.getElementById("previewInvoiceDate")&&(document.getElementById("previewInvoiceDate").textContent=e.invoiceDate||"--"),document.getElementById("previewFromName")&&(document.getElementById("previewFromName").innerHTML=y(e.fromName.replace(/\n/g,"<br>"))),document.getElementById("previewToName")&&(document.getElementById("previewToName").innerHTML=y(e.toName.replace(/\n/g,"<br>"))),this.updatePreviewTable(e.lineItems),document.getElementById("previewTotal")&&(document.getElementById("previewTotal").textContent=h(n));const i=document.getElementById("lightningSection");if(i)if(e.lightningInvoice&&e.lightningInvoice.trim()){i.style.display="block",this.updateLightningDetails(e.lightningInvoice);const o=document.getElementById("qrCodeContainer");o&&(o.style.display="block",this.updateQRCode(e.lightningInvoice))}else i.style.display="none";const t=document.getElementById("notesSection");t&&(e.notes.trim()?(t.style.display="block",document.getElementById("previewNotes").innerHTML=y(e.notes.replace(/\n/g,"<br>"))):t.style.display="none")}async validateLightningAddress(e){const n=e.value.trim();if(e.classList.remove("input-error","input-success"),!n||n.length<3)return this.removeError(e),!1;const t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(n);return t?(e.classList.add("input-success"),this.removeError(e)):n.includes("@")&&n.includes(".")&&(e.classList.add("input-error"),this.showError(e,"Invalid Lightning Address format (e.g., hello@getalby.com)")),t}async generateInvoiceFromAddress(){var o;const e=document.getElementById("lightningAddress"),n=e.value.trim();if(!n){c("Please enter a Lightning Address first","warning");return}if(!await this.validateLightningAddress(e)){c("Please enter a valid Lightning Address","warning");return}const t=this.getFormData().total;if(t<=0){c("Please add line items with a total greater than 0","warning");return}try{c("Generating Lightning invoice...","info");const{LightningAddress:a}=await p(async()=>{const{LightningAddress:s}=await import("./index.modern-GuuHck_z.js");return{LightningAddress:s}},[]),d=new a(n);await d.fetch();const l=await d.requestInvoice({satoshi:t,description:`Invoice ${((o=document.getElementById("invoiceNumber"))==null?void 0:o.value)||"INV-001"}`,expiry:86400});this.currentLightningInvoice=l.paymentRequest,console.log("Generated Lightning Invoice:",{paymentRequest:l.paymentRequest,paymentHash:l.paymentHash,satoshi:l.satoshi,description:l.description,timestamp:l.timestamp,expiry:l.expiry,invoice:l}),this.updatePreview(),c("Lightning invoice generated successfully!","success")}catch(a){console.error("Error generating Lightning invoice:",a),c("Failed to generate Lightning invoice. Please check the address and try again.","error")}}showError(e,n){this.removeError(e);const i=document.createElement("div");i.className="error-message",i.textContent=n,e.parentNode.appendChild(i)}removeError(e){const n=e.parentNode.querySelector(".error-message");n&&n.remove()}generateNewInvoiceNumber(){const e=f(this.settings.defaultInvoicePrefix);document.getElementById("invoiceNumber").value=e,this.updatePreview(),this.saveFormData(),c("New invoice number generated!","success")}clearForm(){if(confirm("Are you sure you want to clear all form data? This action cannot be undone.")){const e=E();document.getElementById("invoiceNumber").value=f(this.settings.defaultInvoicePrefix),document.getElementById("invoiceDate").value=e.invoiceDate,document.getElementById("fromName").value="",document.getElementById("toName").value="",document.getElementById("description").value="",document.getElementById("quantity").value="1",document.getElementById("rate").value="",document.getElementById("lightningAddress").value="",this.currentLightningInvoice="",document.getElementById("notes").value="",this.updatePreview(),this.saveFormData(),c("Form cleared successfully!","success")}}saveFormData(){if(this.settings.autoSave){const e=this.getFormData();T(e)}}loadSavedData(){const e=N();if(e)this.setFormData(e),c("Previous form data loaded!","success");else{const n=E();document.getElementById("invoiceDate").value=n.invoiceDate,document.getElementById("invoiceNumber").value=f(this.settings.defaultInvoicePrefix)}}setupAutoSave(){this.settings.autoSave&&(this.autoSaveTimer=setInterval(()=>{this.saveFormData()},this.settings.autoSaveInterval))}setupTemplateControls(){const e=document.querySelector(".form-panel");if(e&&!document.querySelector(".template-controls")){const n=this.createTemplateControls();e.insertBefore(n,e.firstChild)}}createTemplateControls(){const e=document.createElement("div");return e.className="template-controls",e.innerHTML=`
            <h3>Templates</h3>
            <div class="template-buttons">
                <button type="button" class="btn btn-success" onclick="app.saveCurrentTemplate()">
                    Save Template
                </button>
                <button type="button" class="btn btn-secondary" onclick="app.loadTemplateDialog()">
                    Load Template
                </button>
                <button type="button" class="btn btn-warning" onclick="app.clearForm()">
                    Clear Form
                </button>
                <button type="button" class="btn btn-primary" onclick="app.generateNewInvoiceNumber()">
                    New Invoice #
                </button>
            </div>
        `,e}saveCurrentTemplate(){const e=prompt("Enter template name:");if(e&&e.trim()){const n=this.getFormData();q(e.trim(),n),c(`Template "${e}" saved successfully!`,"success")}}loadTemplateDialog(){const e=_();if(e.length===0){c("No saved templates found.","warning");return}const n=e.map(a=>`<option value="${a}">${a}</option>`).join(""),i=document.createElement("div");i.style.cssText=`
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        `,i.innerHTML=`
            <div style="
                background: #1a1a2e;
                padding: 30px;
                border-radius: 15px;
                border: 1px solid rgba(255, 215, 0, 0.3);
                max-width: 400px;
                width: 90%;
            ">
                <h3 style="color: #ffd700; margin-bottom: 20px;">Load Template</h3>
                <select id="templateSelect" style="
                    width: 100%;
                    padding: 12px;
                    margin-bottom: 20px;
                    background: rgba(255, 255, 255, 0.1);
                    border: 2px solid rgba(255, 215, 0, 0.3);
                    border-radius: 10px;
                    color: white;
                ">
                    ${n}
                </select>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button id="cancelTemplateBtn" style="
                        padding: 10px 20px;
                        background: #6366f1;
                        color: white;
                        border: none;
                        border-radius: 8px;
                        cursor: pointer;
                    ">Cancel</button>
                    <button id="loadTemplateBtn" style="
                        padding: 10px 20px;
                        background: #10b981;
                        color: white;
                        border: none;
                        border-radius: 8px;
                        cursor: pointer;
                    ">Load</button>
                </div>
            </div>
        `,document.body.appendChild(i);const t=i.querySelector("#cancelTemplateBtn"),o=i.querySelector("#loadTemplateBtn");t&&t.addEventListener("click",()=>{i.remove()}),o&&o.addEventListener("click",()=>{this.loadSelectedTemplate(),i.remove()})}loadSelectedTemplate(){const n=document.getElementById("templateSelect").value,i=C(n);i&&(this.setFormData(i),this.updatePreview(),this.saveFormData(),c(`Template "${n}" loaded successfully!`,"success"))}loadVersion(){try{const e="0.0.13",n=document.getElementById("versionDisplay");n&&(n.textContent=`v${e}`)}catch{console.log("Could not load version, using default")}}updateQRCodeSize(){const e=document.querySelector("#qrCodeContainer bitcoin-qr");if(!e)return;const n=Math.min(Math.floor(window.innerWidth/3),300),i=Math.round(n/100)*100;e.setAttribute("width",i),e.setAttribute("height",i)}updateQRCode(e){const n=document.querySelector("#qrCodeContainer bitcoin-qr");n&&e&&(n.setAttribute("lightning",e),this.updateQRCodeSize())}async updateLightningDetails(e){try{const{decodeInvoice:n}=await p(async()=>{const{decodeInvoice:o}=await import("./index.modern-GuuHck_z.js");return{decodeInvoice:o}},[]),i=n(e),t=document.getElementById("lightningExpiry");if(i&&t){if(i.timestamp&&i.expiry){const o=new Date((i.timestamp+i.expiry)*1e3);if(o-new Date>0){const l=o.getMonth()+1,s=o.getDate(),m=o.getFullYear(),u=o.getHours(),g=o.getMinutes(),P=u>=12?"PM":"AM",A=u%12||12,S=g.toString().padStart(2,"0"),D=`${l}/${s}/${m} ${A}:${S} ${P}`;t.textContent=`Expires: ${D}`}else t.textContent="Expired"}else t.textContent="Expiration time not available";t.style.display="inline-block"}else t&&(t.style.display="none")}catch(n){console.error("Error updating Lightning details:",n);const i=document.getElementById("lightningExpiry");i&&(i.style.display="none")}}updatePreviewTable(e){const n=document.getElementById("previewItemsTable");if(n&&(n.innerHTML="",e.forEach(i=>{const t=document.createElement("tr");t.innerHTML=`
                <td>${y(i.description)}</td>
                <td>${i.quantity}</td>
                <td>${h(i.rate)}</td>
                <td class="amount">${h(i.amount)}</td>
            `,n.appendChild(t)}),e.length===0)){const i=document.createElement("tr");i.innerHTML=`
                <td>No items</td>
                <td>0</td>
                <td>0</td>
                <td class="amount">0</td>
            `,n.appendChild(i)}}addLineItem(e="",n=1,i=0){const t=this.getNextItemId(),o=`
            <div class="line-item" data-item-id="${t}">
                <div class="form-group">
                    <label for="description-${t}">Item/Service Description</label>
                    <input type="text" id="description-${t}" placeholder="Bitcoin Consulting Services" class="item-description" value="${e}">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="quantity-${t}">Quantity</label>
                        <input type="number" id="quantity-${t}" placeholder="1" value="${n}" min="1" class="item-quantity">
                    </div>
                    <div class="form-group">
                        <label for="rate-${t}">Price</label>
                        <div class="sats-input">
                            <input type="number" id="rate-${t}" placeholder="100000" min="1" class="item-rate" value="${i}">
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-danger remove-item" data-item-id="${t}">X</button>
            </div>
        `;document.getElementById("lineItemsContainer").insertAdjacentHTML("beforeend",o),this.addLineItemEventListeners(t)}getNextItemId(){const e=document.querySelectorAll(".line-item");let n=0;return e.forEach(i=>{const t=parseInt(i.getAttribute("data-item-id"));t>n&&(n=t)}),n+1}addLineItemEventListeners(e){[document.getElementById(`description-${e}`),document.getElementById(`quantity-${e}`),document.getElementById(`rate-${e}`)].forEach(t=>{t&&t.addEventListener("input",b(()=>{this.updatePreview(),this.saveFormData()},300))});const i=document.querySelector(`[data-item-id="${e}"].remove-item`);i&&i.addEventListener("click",()=>{this.removeLineItem(e)})}removeLineItem(e){const n=document.querySelector(`[data-item-id="${e}"]`);n&&(n.remove(),this.updatePreview(),this.saveFormData())}setupLineItemEventListeners(){document.querySelectorAll(".line-item").forEach(i=>{const t=i.getAttribute("data-item-id");this.addLineItemEventListeners(t)});const n=document.getElementById("addLineItemBtn");n&&n.addEventListener("click",()=>{this.addLineItem()})}}let x;document.addEventListener("DOMContentLoaded",()=>{x=new O,window.app=x});
